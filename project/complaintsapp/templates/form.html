{% extends "base.html" %}

{% block title %}Submit a Complaint{% endblock %}

{% block content %}
    <div class="container mt-4">
        <h2>Submit a Complaint</h2>
        <p>Please fill out the form below to submit a complaint to the council.</p>

        <form method="POST">
            {% csrf_token %}
            {{ form.as_p }}

            <button type="button" class="btn btn-secondary" onclick="getLocation()">Use My Location</button>

            <button type="submit" class="btn btn-primary">Submit Complaint</button>
        </form>

        {% if success %}
        <div class="alert alert-success mt-3">Your complaint has been submitted successfully!</div>
        {% endif %}
    </div>

    <script>
        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(setLocation);
            } else {
                alert("Geolocation is not supported by this browser.");
            }
        }

        function setLocation(position) {
            document.getElementById("id_latitude").value = position.coords.latitude;
            document.getElementById("id_longitude").value = position.coords.longitude;
        }
    </script>
{% endblock %}